# CalendarWidget テスト仕様書

## 概要
- 対象: `src/widgets/calendar/index.ts` `CalendarWidget`
- 目的: カレンダーUI・ノート連携の仕様検証

---

## テストケース一覧

| No. | テスト内容                   | 目的                                 | 結果 | 備考 |
|-----|------------------------------|--------------------------------------|------|------|
| 1   | createでDOM生成              | DOM構造・クラス・タイトル検証        |      |      |
| 2   | 曜日ヘッダー描画             | 曜日表示の正しさ                     |      |      |
| 3   | 月送りボタンで月が変わる      | 月送りUIの動作                       |      |      |
| 4   | 日付セルクリックでノート表示  | ノート情報の表示                     |      |      |
| 5   | デイリーノート無時の表示      | 存在しない場合のメッセージ表示        |      |      |
| 6   | updateExternalSettings反映    | 設定変更の反映                       |      |      |
| 7   | onunloadでクリーンアップ      | 破棄時の状態確認                     |      |      |

---

## 各テストケース詳細

### 1. createでDOM生成
- **テスト対象**: `CalendarWidget.create`
- **目的**: DOM構造・クラス・タイトルが正しいか
- **前提条件**: ダミーconfig/app/pluginを用意
- **入力値・操作**: `widget.create(config, app, plugin)`
- **期待結果**: HTMLElementが返り、`calendar-widget`クラスとタイトルが付与されている
- **手順**:
  1. ダミーconfig/app/pluginを用意
  2. createを呼び出す
  3. DOMを検証
- **実施結果記録**:

---

### 2. 曜日ヘッダー描画
- **テスト対象**: `CalendarWidget.create`
- **目的**: 曜日ヘッダー（日本語）が正しく表示されるか
- **前提条件**: ケース1と同じ
- **入力値・操作**: create後、DOMのth要素を取得
- **期待結果**: ['日','月','火','水','木','金','土']が順に表示されている
- **手順**:
  1. create呼び出し
  2. th要素の内容を検証
- **実施結果記録**:

---

### 3. 月送りボタンで月が変わる
- **テスト対象**: `CalendarWidget.create`, `changeMonth`
- **目的**: 前月・次月ボタンで月が正しく切り替わるか
- **前提条件**: ケース1と同じ
- **入力値・操作**: ボタンのクリックイベントを発火
- **期待結果**: currentDateの月が変化し、カレンダーが再描画される
- **手順**:
  1. create呼び出し
  2. ボタンをクリック
  3. currentDateを検証
- **実施結果記録**:

---

### 4. 日付セルクリックでノート情報が表示される
- **テスト対象**: `CalendarWidget.showNotesForDate`（内部）
- **目的**: 日付セルクリックで該当日のノート情報が正しく表示されるか
- **前提条件**: デイリーノート・その他ノートを含むダミーファイルを用意
- **入力値・操作**: 日付セル(td)のクリックイベントを発火
- **期待結果**: 選択日情報エリアに「ノート一覧」「デイリーノートを開く」「ノート名」等が表示される
- **手順**:
  1. create呼び出し
  2. tdクリック
  3. infoエリアの内容を検証
- **実施結果記録**:

---

### 5. デイリーノートが存在しない場合の表示
- **テスト対象**: `CalendarWidget.showNotesForDate`（内部）
- **目的**: デイリーノートが存在しない場合のメッセージ表示
- **前提条件**: デイリーノートが存在しないダミーファイルのみ用意
- **入力値・操作**: 日付セル(td)のクリックイベントを発火
- **期待結果**: 「デイリーノートは存在しません」と表示される
- **手順**:
  1. create呼び出し
  2. tdクリック
  3. infoエリアの内容を検証
- **実施結果記録**:

---

### 6. updateExternalSettingsで設定が反映される
- **テスト対象**: `CalendarWidget.updateExternalSettings`
- **目的**: 設定変更（dailyNoteFormat等）がcurrentSettingsに反映されるか
- **前提条件**: ケース1と同じ
- **入力値・操作**: updateExternalSettings({ dailyNoteFormat: 'YYYY年MM月DD日' })
- **期待結果**: currentSettings.dailyNoteFormatが新しい値になる
- **手順**:
  1. create呼び出し
  2. updateExternalSettings呼び出し
  3. 設定値を検証
- **実施結果記録**:

---

### 7. onunloadでクリーンアップが行われる
- **テスト対象**: `CalendarWidget.onunload`
- **目的**: ウィジェット破棄時にwidgetEl等が適切にクリーンアップされるか
- **前提条件**: ケース1と同じ
- **入力値・操作**: onunload呼び出し
- **期待結果**: widgetElが定義されている（現状は副作用なし）
- **手順**:
  1. create呼び出し
  2. onunload呼び出し
  3. widgetElを検証
- **実施結果記録**:

---

## 進捗・メモ

- [ ] ケース1 実施済み
- [ ] ケース2 未実施
- [ ] ケース3 未実施
- [ ] ケース4 未実施
- [ ] ケース5 未実施
- [ ] ケース6 未実施
- [ ] ケース7 未実施 